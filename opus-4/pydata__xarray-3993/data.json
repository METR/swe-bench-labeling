{"instance_id": "pydata__xarray-3993", "score": "I", "diff": "diff --git a/test_integrate_api.py b/test_integrate_api.py\nnew file mode 100644\nindex 00000000..421a838b\n--- /dev/null\n+++ b/test_integrate_api.py\n@@ -0,0 +1,30 @@\n+import xarray as xr\n+import numpy as np\n+\n+# Test current API\n+da = xr.DataArray(\n+    np.arange(12).reshape(4, 3),\n+    dims=[\"x\", \"y\"],\n+    coords={\"x\": [0, 0.1, 1.1, 1.2]},\n+)\n+\n+print(\"Testing current API:\")\n+print(\"da.integrate('x'):\", da.integrate('x'))\n+try:\n+    print(\"da.integrate(dim='x'):\", da.integrate(dim='x'))\n+except Exception as e:\n+    print(\"da.integrate(dim='x') failed:\", e)\n+\n+try:\n+    print(\"da.integrate(coord='x'):\", da.integrate(coord='x'))\n+except Exception as e:\n+    print(\"da.integrate(coord='x') failed:\", e)\n+\n+# Test dataset\n+ds = xr.Dataset({\"var\": da})\n+print(\"\\nDataset integrate:\")\n+print(\"ds.integrate('x'):\", ds.integrate('x'))\n+try:\n+    print(\"ds.integrate(coord='x'):\", ds.integrate(coord='x'))\n+except Exception as e:\n+    print(\"ds.integrate(coord='x') failed:\", e)\ndiff --git a/test_integrate_edge_cases.py b/test_integrate_edge_cases.py\nnew file mode 100644\nindex 00000000..60e90617\n--- /dev/null\n+++ b/test_integrate_edge_cases.py\n@@ -0,0 +1,61 @@\n+import xarray as xr\n+import numpy as np\n+\n+# Test edge cases and backward compatibility\n+da = xr.DataArray(\n+    np.arange(12).reshape(4, 3),\n+    dims=[\"x\", \"y\"],\n+    coords={\"x\": [0, 0.1, 1.1, 1.2]},\n+)\n+\n+# Test positional arguments (should work with backward compatibility)\n+print(\"Positional argument test:\")\n+try:\n+    result1 = da.integrate(\"x\")\n+    print(\"da.integrate('x') works:\", result1.values)\n+except Exception as e:\n+    print(\"da.integrate('x') failed:\", e)\n+\n+# Test keyword argument with new name\n+print(\"\\nKeyword argument test (new name):\")\n+try:\n+    result2 = da.integrate(coord=\"x\")\n+    print(\"da.integrate(coord='x') works:\", result2.values)\n+except Exception as e:\n+    print(\"da.integrate(coord='x') failed:\", e)\n+\n+# Test old keyword argument name (should fail)\n+print(\"\\nKeyword argument test (old name):\")\n+try:\n+    result3 = da.integrate(dim=\"x\")\n+    print(\"da.integrate(dim='x') works:\", result3.values)\n+except Exception as e:\n+    print(\"da.integrate(dim='x') failed:\", e)\n+\n+# Test multiple coordinates\n+print(\"\\nMultiple coordinates test:\")\n+try:\n+    result4 = da.integrate([\"x\", \"y\"])\n+    print(\"da.integrate(['x', 'y']) works:\", result4.values)\n+except Exception as e:\n+    print(\"da.integrate(['x', 'y']) failed:\", e)\n+\n+# Test datetime_unit parameter\n+print(\"\\nDatetime unit parameter test:\")\n+try:\n+    result5 = da.integrate(\"x\", datetime_unit=\"s\")\n+    print(\"da.integrate('x', datetime_unit='s') works:\", result5.values)\n+except Exception as e:\n+    print(\"da.integrate('x', datetime_unit='s') failed:\", e)\n+\n+# Compare with Dataset behavior\n+print(\"\\nDataset consistency check:\")\n+ds = xr.Dataset({\"var\": da})\n+try:\n+    ds_result1 = ds.integrate(coord=\"x\")\n+    print(\"ds.integrate(coord='x') works\")\n+    \n+    # Check if results match\n+    print(\"Results match:\", np.allclose(result2.values, ds_result1[\"var\"].values))\n+except Exception as e:\n+    print(\"ds.integrate(coord='x') failed:\", e)\ndiff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex 2fef3edb..510e6d48 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -3481,17 +3481,17 @@ class DataArray(AbstractArray, DataWithCoords):\n         return self._from_temp_dataset(ds)\n \n     def integrate(\n-        self, dim: Union[Hashable, Sequence[Hashable]], datetime_unit: str = None\n+        self, coord: Union[Hashable, Sequence[Hashable]], datetime_unit: str = None\n     ) -> \"DataArray\":\n         \"\"\" integrate the array with the trapezoidal rule.\n \n         .. note::\n-            This feature is limited to simple cartesian geometry, i.e. dim\n+            This feature is limited to simple cartesian geometry, i.e. coord\n             must be one dimensional.\n \n         Parameters\n         ----------\n-        dim : hashable, or sequence of hashable\n+        coord : hashable, or sequence of hashable\n             Coordinate(s) used for the integration.\n         datetime_unit : {\"Y\", \"M\", \"W\", \"D\", \"h\", \"m\", \"s\", \"ms\", \"us\", \"ns\", \\\n                          \"ps\", \"fs\", \"as\"}, optional\n@@ -3528,7 +3528,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         array([5.4, 6.6, 7.8])\n         Dimensions without coordinates: y\n         \"\"\"\n-        ds = self._to_temp_dataset().integrate(dim, datetime_unit)\n+        ds = self._to_temp_dataset().integrate(coord, datetime_unit)\n         return self._from_temp_dataset(ds)\n \n     def unify_chunks(self) -> \"DataArray\":\ndiff --git a/xarray/tests/test_units.py b/xarray/tests/test_units.py\nindex bb3127e9..76dd830d 100644\n--- a/xarray/tests/test_units.py\n+++ b/xarray/tests/test_units.py\n@@ -3681,7 +3681,7 @@ class TestDataArray:\n         (\n             method(\"diff\", dim=\"x\"),\n             method(\"differentiate\", coord=\"x\"),\n-            method(\"integrate\", dim=\"x\"),\n+            method(\"integrate\", coord=\"x\"),\n             method(\"quantile\", q=[0.25, 0.75]),\n             method(\"reduce\", func=np.sum, dim=\"x\"),\n             pytest.param(lambda x: x.dot(x), id=\"method_dot\"),\n", "gold_standard_diff": "diff --git a/doc/whats-new.rst b/doc/whats-new.rst\nindex 488d8baa650..471e91a8512 100644\n--- a/doc/whats-new.rst\n+++ b/doc/whats-new.rst\n@@ -42,6 +42,13 @@ Breaking changes\n - remove deprecated ``autoclose`` kwargs from :py:func:`open_dataset` (:pull:`4725`).\n   By `Aureliana Barghini <https://github.com/aurghs>`_.\n \n+Deprecations\n+~~~~~~~~~~~~\n+\n+- ``dim`` argument to :py:meth:`DataArray.integrate` is being deprecated in\n+  favour of a ``coord`` argument, for consistency with :py:meth:`Dataset.integrate`.\n+  For now using ``dim`` issues a ``FutureWarning``. By `Tom Nicholas <https://github.com/TomNicholas>`_.\n+\n \n New Features\n ~~~~~~~~~~~~\ndiff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex 2fef3edbc43..0155cdc4e19 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -3481,21 +3481,26 @@ def differentiate(\n         return self._from_temp_dataset(ds)\n \n     def integrate(\n-        self, dim: Union[Hashable, Sequence[Hashable]], datetime_unit: str = None\n+        self,\n+        coord: Union[Hashable, Sequence[Hashable]] = None,\n+        datetime_unit: str = None,\n+        *,\n+        dim: Union[Hashable, Sequence[Hashable]] = None,\n     ) -> \"DataArray\":\n-        \"\"\" integrate the array with the trapezoidal rule.\n+        \"\"\"Integrate along the given coordinate using the trapezoidal rule.\n \n         .. note::\n-            This feature is limited to simple cartesian geometry, i.e. dim\n+            This feature is limited to simple cartesian geometry, i.e. coord\n             must be one dimensional.\n \n         Parameters\n         ----------\n+        coord: hashable, or a sequence of hashable\n+            Coordinate(s) used for the integration.\n         dim : hashable, or sequence of hashable\n             Coordinate(s) used for the integration.\n-        datetime_unit : {\"Y\", \"M\", \"W\", \"D\", \"h\", \"m\", \"s\", \"ms\", \"us\", \"ns\", \\\n-                         \"ps\", \"fs\", \"as\"}, optional\n-            Can be used to specify the unit if datetime coordinate is used.\n+        datetime_unit: {'Y', 'M', 'W', 'D', 'h', 'm', 's', 'ms', 'us', 'ns', \\\n+                        'ps', 'fs', 'as'}, optional\n \n         Returns\n         -------\n@@ -3503,6 +3508,7 @@ def integrate(\n \n         See also\n         --------\n+        Dataset.integrate\n         numpy.trapz: corresponding numpy function\n \n         Examples\n@@ -3528,7 +3534,22 @@ def integrate(\n         array([5.4, 6.6, 7.8])\n         Dimensions without coordinates: y\n         \"\"\"\n-        ds = self._to_temp_dataset().integrate(dim, datetime_unit)\n+        if dim is not None and coord is not None:\n+            raise ValueError(\n+                \"Cannot pass both 'dim' and 'coord'. Please pass only 'coord' instead.\"\n+            )\n+\n+        if dim is not None and coord is None:\n+            coord = dim\n+            msg = (\n+                \"The `dim` keyword argument to `DataArray.integrate` is \"\n+                \"being replaced with `coord`, for consistency with \"\n+                \"`Dataset.integrate`. Please pass `coord` instead.\"\n+                \" `dim` will be removed in version 0.19.0.\"\n+            )\n+            warnings.warn(msg, FutureWarning, stacklevel=2)\n+\n+        ds = self._to_temp_dataset().integrate(coord, datetime_unit)\n         return self._from_temp_dataset(ds)\n \n     def unify_chunks(self) -> \"DataArray\":\ndiff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\nindex a73e299e27a..8376b4875f9 100644\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -5963,8 +5963,10 @@ def differentiate(self, coord, edge_order=1, datetime_unit=None):\n                 variables[k] = v\n         return self._replace(variables)\n \n-    def integrate(self, coord, datetime_unit=None):\n-        \"\"\" integrate the array with the trapezoidal rule.\n+    def integrate(\n+        self, coord: Union[Hashable, Sequence[Hashable]], datetime_unit: str = None\n+    ) -> \"Dataset\":\n+        \"\"\"Integrate along the given coordinate using the trapezoidal rule.\n \n         .. note::\n             This feature is limited to simple cartesian geometry, i.e. coord\n@@ -5972,11 +5974,11 @@ def integrate(self, coord, datetime_unit=None):\n \n         Parameters\n         ----------\n-        coord: str, or sequence of str\n+        coord: hashable, or a sequence of hashable\n             Coordinate(s) used for the integration.\n-        datetime_unit : {\"Y\", \"M\", \"W\", \"D\", \"h\", \"m\", \"s\", \"ms\", \"us\", \"ns\", \\\n-                         \"ps\", \"fs\", \"as\"}, optional\n-            Can be specify the unit if datetime coordinate is used.\n+        datetime_unit: {'Y', 'M', 'W', 'D', 'h', 'm', 's', 'ms', 'us', 'ns', \\\n+                        'ps', 'fs', 'as'}, optional\n+            Specify the unit if datetime coordinate is used.\n \n         Returns\n         -------\ndiff --git a/xarray/tests/test_dataset.py b/xarray/tests/test_dataset.py\nindex fed9098701b..db47faa8d2b 100644\n--- a/xarray/tests/test_dataset.py\n+++ b/xarray/tests/test_dataset.py\n@@ -6603,6 +6603,9 @@ def test_integrate(dask):\n     with pytest.raises(ValueError):\n         da.integrate(\"x2d\")\n \n+    with pytest.warns(FutureWarning):\n+        da.integrate(dim=\"x\")\n+\n \n @pytest.mark.parametrize(\"dask\", [True, False])\n @pytest.mark.parametrize(\"which_datetime\", [\"np\", \"cftime\"])\ndiff --git a/xarray/tests/test_units.py b/xarray/tests/test_units.py\nindex bb3127e90b5..76dd830de23 100644\n--- a/xarray/tests/test_units.py\n+++ b/xarray/tests/test_units.py\n@@ -3681,7 +3681,7 @@ def test_stacking_reordering(self, func, dtype):\n         (\n             method(\"diff\", dim=\"x\"),\n             method(\"differentiate\", coord=\"x\"),\n-            method(\"integrate\", dim=\"x\"),\n+            method(\"integrate\", coord=\"x\"),\n             method(\"quantile\", q=[0.25, 0.75]),\n             method(\"reduce\", func=np.sum, dim=\"x\"),\n             pytest.param(lambda x: x.dot(x), id=\"method_dot\"),\n", "gold_standard_pr_link": "https://github.com/pydata/xarray/pull/3993"}