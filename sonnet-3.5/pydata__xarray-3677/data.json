{"instance_id": "pydata__xarray-3677", "score": "C", "diff": "diff --git a/xarray/core/merge.py b/xarray/core/merge.py\nindex 10c7804d..4058ff36 100644\n--- a/xarray/core/merge.py\n+++ b/xarray/core/merge.py\n@@ -809,6 +809,11 @@ def dataset_merge_method(\n     # method due for backwards compatibility\n     # TODO: consider deprecating it?\n \n+    from .dataarray import DataArray\n+\n+    if isinstance(other, DataArray):\n+        other = other.to_dataset()\n+\n     if isinstance(overwrite_vars, Iterable) and not isinstance(overwrite_vars, str):\n         overwrite_vars = set(overwrite_vars)\n     else:\n", "gold_standard_diff": "From c03c7c80c77bcce8e7260406461fe535de5f9928 Mon Sep 17 00:00:00 2001\nFrom: Thomas Nicholas <tegn500@york.ac.uk>\nDate: Thu, 9 Jan 2020 15:56:32 +0000\nSubject: [PATCH 1/5] Added mwe as test\n\n---\n xarray/tests/test_merge.py | 6 ++++++\n 1 file changed, 6 insertions(+)\n\ndiff --git a/xarray/tests/test_merge.py b/xarray/tests/test_merge.py\nindex c1e6c7a5ce8..ed786584af9 100644\n--- a/xarray/tests/test_merge.py\n+++ b/xarray/tests/test_merge.py\n@@ -253,3 +253,9 @@ def test_merge_no_conflicts(self):\n         with pytest.raises(xr.MergeError):\n             ds3 = xr.Dataset({\"a\": (\"y\", [2, 3]), \"y\": [1, 2]})\n             ds1.merge(ds3, compat=\"no_conflicts\")\n+\n+    def test_merge_dataarray(self):\n+        ds = xr.Dataset({'a': 0})\n+        da = xr.DataArray(data=1, name='b')\n+\n+        assert ds.merge(da).identical(xr.merge([ds, da]))\n\nFrom 211fa9acca42787fbb34ee3354b4f1c5d6ba1ab2 Mon Sep 17 00:00:00 2001\nFrom: Thomas Nicholas <tegn500@york.ac.uk>\nDate: Thu, 9 Jan 2020 15:56:48 +0000\nSubject: [PATCH 2/5] Cast to Dataset\n\n---\n xarray/core/dataset.py | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\nindex ac0a923db78..d597ec8cfb0 100644\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -3604,6 +3604,7 @@ def merge(\n             If any variables conflict (see ``compat``).\n         \"\"\"\n         _check_inplace(inplace)\n+        other = other.to_dataset() if isinstance(other, xr.DataArray) else other\n         merge_result = dataset_merge_method(\n             self,\n             other,\n\nFrom 8a60abcbd68fa8d831226ed32df718c38b8131e2 Mon Sep 17 00:00:00 2001\nFrom: Thomas Nicholas <tegn500@york.ac.uk>\nDate: Thu, 9 Jan 2020 15:59:20 +0000\nSubject: [PATCH 3/5] Updated what's new\n\n---\n doc/whats-new.rst | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a/doc/whats-new.rst b/doc/whats-new.rst\nindex 5a9f2497ed6..e69fbadea34 100644\n--- a/doc/whats-new.rst\n+++ b/doc/whats-new.rst\n@@ -70,6 +70,8 @@ Bug fixes\n   By `Justus Magin <https://github.com/keewis>`_.\n - :py:meth:`Dataset.rename`, :py:meth:`DataArray.rename` now check for conflicts with\n   MultiIndex level names.\n+- :py:meth:`Dataset.merge` no longer fails when passed a `DataArray` instead of a `Dataset` object.\n+  By `Tom Nicholas <https://github.com/TomNicholas>`_.\n \n Documentation\n ~~~~~~~~~~~~~\n\nFrom c0c809d6c5204ea27559752974ebbda3668ed887 Mon Sep 17 00:00:00 2001\nFrom: Thomas Nicholas <tegn500@york.ac.uk>\nDate: Thu, 9 Jan 2020 16:09:04 +0000\nSubject: [PATCH 4/5] black formatted\n\n---\n xarray/tests/test_merge.py | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a/xarray/tests/test_merge.py b/xarray/tests/test_merge.py\nindex ed786584af9..e598994a619 100644\n--- a/xarray/tests/test_merge.py\n+++ b/xarray/tests/test_merge.py\n@@ -255,7 +255,7 @@ def test_merge_no_conflicts(self):\n             ds1.merge(ds3, compat=\"no_conflicts\")\n \n     def test_merge_dataarray(self):\n-        ds = xr.Dataset({'a': 0})\n-        da = xr.DataArray(data=1, name='b')\n+        ds = xr.Dataset({\"a\": 0})\n+        da = xr.DataArray(data=1, name=\"b\")\n \n         assert ds.merge(da).identical(xr.merge([ds, da]))\n\nFrom 2901cacca452776d453c60b7e7af0393cdac95a9 Mon Sep 17 00:00:00 2001\nFrom: Thomas Nicholas <tegn500@york.ac.uk>\nDate: Thu, 9 Jan 2020 16:11:50 +0000\nSubject: [PATCH 5/5] Use assert_identical\n\n---\n xarray/tests/test_merge.py | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a/xarray/tests/test_merge.py b/xarray/tests/test_merge.py\nindex e598994a619..6c8f3f65657 100644\n--- a/xarray/tests/test_merge.py\n+++ b/xarray/tests/test_merge.py\n@@ -3,6 +3,7 @@\n \n import xarray as xr\n from xarray.core import dtypes, merge\n+from xarray.testing import assert_identical\n \n from . import raises_regex\n from .test_dataset import create_test_data\n@@ -258,4 +259,4 @@ def test_merge_dataarray(self):\n         ds = xr.Dataset({\"a\": 0})\n         da = xr.DataArray(data=1, name=\"b\")\n \n-        assert ds.merge(da).identical(xr.merge([ds, da]))\n+        assert_identical(ds.merge(da), xr.merge([ds, da]))\n", "gold_standard_pr_link": "https://github.com/pydata/xarray/pull/3677"}