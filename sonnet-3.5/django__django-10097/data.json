{"instance_id": "django__django-10097", "score": "I", "diff": "diff --git a/django/core/validators.py b/django/core/validators.py\nindex 92394a7eae..51f191812d 100644\n--- a/django/core/validators.py\n+++ b/django/core/validators.py\n@@ -536,3 +536,17 @@ class ProhibitNullCharactersValidator:\n             self.message == other.message and\n             self.code == other.code\n         )\n+\n+    def validate_auth_characters(self, url):\n+        \"\"\"\n+        Validate that the username and password in the URL do not contain invalid characters.\n+        \"\"\"\n+        import re\n+        auth_part = re.match(r'^(?:[a-z0-9\\.\\-\\+]*)://(?:([^@]+)@)?', url, re.IGNORECASE)\n+        if auth_part and auth_part.group(1):\n+            if re.search(r'[/:@]', auth_part.group(1)):\n+                raise ValidationError(self.message, code=self.code)\n+\n+    def __call__(self, value):\n+        super().__call__(value)\n+        self.validate_auth_characters(value)\n", "gold_standard_diff": "diff --git a/django/core/validators.py b/django/core/validators.py\nindex 92394a7eaead..c1c9cd1c87e8 100644\n--- a/django/core/validators.py\n+++ b/django/core/validators.py\n@@ -94,7 +94,7 @@ class URLValidator(RegexValidator):\n \n     regex = _lazy_re_compile(\n         r'^(?:[a-z0-9\\.\\-\\+]*)://'  # scheme is validated separately\n-        r'(?:\\S+(?::\\S*)?@)?'  # user:pass authentication\n+        r'(?:[^\\s:@/]+(?::[^\\s:@/]*)?@)?'  # user:pass authentication\n         r'(?:' + ipv4_re + '|' + ipv6_re + '|' + host_re + ')'\n         r'(?::\\d{2,5})?'  # port\n         r'(?:[/?#][^\\s]*)?'  # resource path\ndiff --git a/tests/validators/invalid_urls.txt b/tests/validators/invalid_urls.txt\nindex 04a0b5fb1b5f..4a092034ff66 100644\n--- a/tests/validators/invalid_urls.txt\n+++ b/tests/validators/invalid_urls.txt\n@@ -57,3 +57,9 @@ http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\n http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n http://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaa\n https://test.[com\n+http://foo@bar@example.com\n+http://foo/bar@example.com\n+http://foo:bar:baz@example.com\n+http://foo:bar@baz@example.com\n+http://foo:bar/baz@example.com\n+http://invalid-.com/?m=foo@example.com\ndiff --git a/tests/validators/valid_urls.txt b/tests/validators/valid_urls.txt\nindex 4bc8c03059c0..f79f94814291 100644\n--- a/tests/validators/valid_urls.txt\n+++ b/tests/validators/valid_urls.txt\n@@ -48,7 +48,7 @@ http://foo.bar/?q=Test%20URL-encoded%20stuff\n http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631\n http://\u4f8b\u5b50.\u6d4b\u8bd5\n http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e\n-http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\n+http://-.~_!$&'()*+,;=%40:80%2f@example.com\n http://xn--7sbb4ac0ad0be6cf.xn--p1ai\n http://1337.net\n http://a.b-c.de\n", "gold_standard_pr_link": "https://github.com/django/django/pull/10097"}