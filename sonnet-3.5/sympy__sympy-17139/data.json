{"instance_id": "sympy__sympy-17139", "score": "I", "diff": "diff --git a/sympy/simplify/fu.py b/sympy/simplify/fu.py\nindex ad1130ef96..873d54fa8d 100644\n--- a/sympy/simplify/fu.py\n+++ b/sympy/simplify/fu.py\n@@ -501,24 +501,29 @@ def _f(rv):\n         if not (rv.is_Pow and rv.base.func == f):\n             return rv\n \n-        if (rv.exp < 0) == True:\n+        from sympy import sympify, re\n+        exp = sympify(rv.exp)\n+        \n+        if exp.is_complex:\n             return rv\n-        if (rv.exp > max) == True:\n+        if re(exp) < 0:\n             return rv\n-        if rv.exp == 2:\n+        if re(exp) > max:\n+            return rv\n+        if exp == 2:\n             return h(g(rv.base.args[0])**2)\n         else:\n-            if rv.exp == 4:\n+            if exp == 4:\n                 e = 2\n             elif not pow:\n-                if rv.exp % 2:\n+                if exp % 2:\n                     return rv\n-                e = rv.exp//2\n+                e = exp//2\n             else:\n-                p = perfect_power(rv.exp)\n+                p = perfect_power(exp)\n                 if not p:\n                     return rv\n-                e = rv.exp//2\n+                e = exp//2\n             return h(g(rv.base.args[0])**2)**e\n \n     return bottom_up(rv, _f)\n", "gold_standard_diff": "From d1c039406ffc89d06aa89188be4c0b7a853a49dd Mon Sep 17 00:00:00 2001\nFrom: eward <eward@sunbelt-medical.com>\nDate: Mon, 1 Jul 2019 12:13:50 -0700\nSubject: [PATCH 1/3] _TR56 test exp is real\n\n---\n sympy/simplify/fu.py | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a/sympy/simplify/fu.py b/sympy/simplify/fu.py\nindex ad1130ef96ea..612bc0bb6900 100644\n--- a/sympy/simplify/fu.py\n+++ b/sympy/simplify/fu.py\n@@ -500,6 +500,8 @@ def _f(rv):\n         # change is not going to allow a simplification as far as I can tell.\n         if not (rv.is_Pow and rv.base.func == f):\n             return rv\n+        if not rv.exp.is_real:\n+            return rv\n \n         if (rv.exp < 0) == True:\n             return rv\n\nFrom 4e910a730956fc35bbfed226161001de4ea79dd0 Mon Sep 17 00:00:00 2001\nFrom: eward <eward@sunbelt-medical.com>\nDate: Mon, 1 Jul 2019 12:14:08 -0700\nSubject: [PATCH 2/3] test__TR56 complex exponents\n\n---\n sympy/simplify/tests/test_fu.py | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a/sympy/simplify/tests/test_fu.py b/sympy/simplify/tests/test_fu.py\nindex 54be6e1dca48..b2d2604a450b 100644\n--- a/sympy/simplify/tests/test_fu.py\n+++ b/sympy/simplify/tests/test_fu.py\n@@ -76,6 +76,10 @@ def test__TR56():\n     assert T(sin(x)**6, sin, cos, h, 6, True) == sin(x)**6\n     assert T(sin(x)**8, sin, cos, h, 10, True) == (-cos(x)**2 + 1)**4\n \n+    # issue 17137\n+    assert T(sin(x)**I, sin, cos, h, 4, True) == sin(x)**I\n+    assert T(sin(x)**(2*I + 1), sin, cos, h, 4, True) == sin(x)**(2*I + 1)\n+\n \n def test_TR5():\n     assert TR5(sin(x)**2) == -cos(x)**2 + 1\n\nFrom 4729a80f0b89acd542f6c1b461fe6ec245000a75 Mon Sep 17 00:00:00 2001\nFrom: eward <eward@sunbelt-medical.com>\nDate: Mon, 1 Jul 2019 13:15:22 -0700\nSubject: [PATCH 3/3] test_issue_17137\n\n---\n sympy/simplify/tests/test_simplify.py | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a/sympy/simplify/tests/test_simplify.py b/sympy/simplify/tests/test_simplify.py\nindex a8611ec385af..1794c453c572 100644\n--- a/sympy/simplify/tests/test_simplify.py\n+++ b/sympy/simplify/tests/test_simplify.py\n@@ -806,3 +806,8 @@ def test_issue_15965():\n     assert simplify(A + B) == anew + bnew\n     assert simplify(A) == anew\n     assert simplify(B) == bnew\n+\n+\n+def test_issue_17137():\n+    assert simplify(cos(x)**I) == cos(x)**I\n+    assert simplify(cos(x)**(2 + 3*I)) == cos(x)**(2 + 3*I)\n", "gold_standard_pr_link": "https://github.com/sympy/sympy/pull/17139"}