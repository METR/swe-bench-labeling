{"instance_id": "pydata__xarray-6599", "score": "C", "diff": "diff --git a/xarray/core/computation.py b/xarray/core/computation.py\nindex 823cbe02..2e200e91 100644\n--- a/xarray/core/computation.py\n+++ b/xarray/core/computation.py\n@@ -1918,22 +1918,24 @@ def polyval(\n \n \n def _ensure_numeric(data: T_Xarray) -> T_Xarray:\n-    \"\"\"Converts all datetime64 variables to float64\n+    \"\"\"Converts all datetime64 and timedelta64 variables to float64\n \n     Parameters\n     ----------\n     data : DataArray or Dataset\n-        Variables with possible datetime dtypes.\n+        Variables with possible datetime or timedelta dtypes.\n \n     Returns\n     -------\n     DataArray or Dataset\n-        Variables with datetime64 dtypes converted to float64.\n+        Variables with datetime64 and timedelta64 dtypes converted to float64.\n     \"\"\"\n     from .dataset import Dataset\n \n     def to_floatable(x: DataArray) -> DataArray:\n-        if x.dtype.kind in \"mM\":\n+        if x.dtype.kind == 'm':  # timedelta64\n+            return x.copy(data=x.data.astype(np.float64))\n+        elif x.dtype.kind == 'M':  # datetime64\n             return x.copy(\n                 data=datetime_to_numeric(\n                     x.data,\n", "gold_standard_diff": "From f678977f470f0e752150d97afc4487d7c7647036 Mon Sep 17 00:00:00 2001\nFrom: Michael Niklas <mick.niklas@gmail.com>\nDate: Thu, 12 May 2022 17:11:56 +0200\nSubject: [PATCH 1/2] re-add timedelta support for polyval\n\n---\n xarray/core/computation.py       | 6 +++++-\n xarray/tests/test_computation.py | 6 ++++++\n 2 files changed, 11 insertions(+), 1 deletion(-)\n\ndiff --git a/xarray/core/computation.py b/xarray/core/computation.py\nindex 823cbe02560..8d450cceef9 100644\n--- a/xarray/core/computation.py\n+++ b/xarray/core/computation.py\n@@ -1933,7 +1933,8 @@ def _ensure_numeric(data: T_Xarray) -> T_Xarray:\n     from .dataset import Dataset\n \n     def to_floatable(x: DataArray) -> DataArray:\n-        if x.dtype.kind in \"mM\":\n+        if x.dtype.kind == \"M\":\n+            # datetimes\n             return x.copy(\n                 data=datetime_to_numeric(\n                     x.data,\n@@ -1941,6 +1942,9 @@ def to_floatable(x: DataArray) -> DataArray:\n                     datetime_unit=\"ns\",\n                 ),\n             )\n+        elif x.dtype.kind == \"m\":\n+            # timedeltas\n+            return x.astype(float)\n         return x\n \n     if isinstance(data, Dataset):\ndiff --git a/xarray/tests/test_computation.py b/xarray/tests/test_computation.py\nindex 737ed82bc05..a3156214c08 100644\n--- a/xarray/tests/test_computation.py\n+++ b/xarray/tests/test_computation.py\n@@ -2010,6 +2010,12 @@ def test_where_attrs() -> None:\n             ),\n             id=\"datetime\",\n         ),\n+        pytest.param(\n+            xr.DataArray(np.array([1000, 2000, 3000], dtype=\"timedelta64[ns]\"), dims=\"x\"),\n+            xr.DataArray([0, 1], dims=\"degree\", coords={\"degree\": [0, 1]}),\n+            xr.DataArray([1000.0, 2000.0, 3000.0], dims=\"x\"),\n+            id=\"timedelta\",\n+        ),\n     ],\n )\n def test_polyval(\n\nFrom 01b8638ba6251c8987d512484c00960540bbea7a Mon Sep 17 00:00:00 2001\nFrom: \"pre-commit-ci[bot]\"\n <66853113+pre-commit-ci[bot]@users.noreply.github.com>\nDate: Thu, 12 May 2022 15:14:24 +0000\nSubject: [PATCH 2/2] [pre-commit.ci] auto fixes from pre-commit.com hooks\n\nfor more information, see https://pre-commit.ci\n---\n xarray/tests/test_computation.py | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a/xarray/tests/test_computation.py b/xarray/tests/test_computation.py\nindex a3156214c08..b8aa05c75e7 100644\n--- a/xarray/tests/test_computation.py\n+++ b/xarray/tests/test_computation.py\n@@ -2011,7 +2011,9 @@ def test_where_attrs() -> None:\n             id=\"datetime\",\n         ),\n         pytest.param(\n-            xr.DataArray(np.array([1000, 2000, 3000], dtype=\"timedelta64[ns]\"), dims=\"x\"),\n+            xr.DataArray(\n+                np.array([1000, 2000, 3000], dtype=\"timedelta64[ns]\"), dims=\"x\"\n+            ),\n             xr.DataArray([0, 1], dims=\"degree\", coords={\"degree\": [0, 1]}),\n             xr.DataArray([1000.0, 2000.0, 3000.0], dims=\"x\"),\n             id=\"timedelta\",\n", "gold_standard_pr_link": "https://github.com/pydata/xarray/pull/6599"}