{"instance_id": "psf__requests-1766", "score": "I", "diff": "diff --git a/requests/auth.py b/requests/auth.py\nindex a3de123d..48416e5f 100644\n--- a/requests/auth.py\n+++ b/requests/auth.py\n@@ -144,7 +144,7 @@ class HTTPDigestAuth(AuthBase):\n         if entdig:\n             base += ', digest=\"%s\"' % entdig\n         if qop:\n-            base += ', qop=auth, nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n+            base += ', qop=\"auth\", nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n \n         return 'Digest %s' % (base)\n \n", "gold_standard_diff": "From 649dac1029ad51e01091a06feac81f199249cfc3 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?=E4=BD=90=E8=97=A4=20=E5=BB=BA=E5=A4=AA?=\n <bicycle1885@gmail.com>\nDate: Fri, 29 Nov 2013 15:28:47 +0900\nSubject: [PATCH 1/2] quote qop options in Digest Auth\n\nBased on RFC2617 (http://tools.ietf.org/html/rfc2617), the value of\n'qop-options' directive should be quoted with double quotes:\n\n    qop-options\n         This directive is optional, but is made so only for backward\n         compatibility with RFC 2069 [6]; it SHOULD be used by all\n         implementations compliant with this version of the Digest\n         scheme. If present, it is a quoted string of one or more\n         tokens indicating the \"quality of protection\" values supported by\n         the server.  The value \"auth\" indicates authentication; the\n         value \"auth-int\" indicates authentication with\n         integrity protection; see the\n\ncurl comamnd-line tool also appends these quotes. You can see this\nby `curl -v --digest --user user:passwd http://example.com/digest-auth`.\nUnfortunately, some minor server-side implementations seem to be sensitive\non this difference.\n---\n requests/auth.py | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a/requests/auth.py b/requests/auth.py\nindex a3de123d30..48416e5f4a 100644\n--- a/requests/auth.py\n+++ b/requests/auth.py\n@@ -144,7 +144,7 @@ def sha_utf8(x):\n         if entdig:\n             base += ', digest=\"%s\"' % entdig\n         if qop:\n-            base += ', qop=auth, nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n+            base += ', qop=\"auth\", nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n \n         return 'Digest %s' % (base)\n \n\nFrom fecb35a08ec77d6392bdc609ab1ea21943e40228 Mon Sep 17 00:00:00 2001\nFrom: Cory Benfield <lukasaoz@gmail.com>\nDate: Fri, 29 Nov 2013 08:37:25 +0000\nSubject: [PATCH 2/2] Quote qop values in digest auth.\n\n---\n requests/auth.py | 4 ++--\n test_requests.py | 8 ++++++++\n 2 files changed, 10 insertions(+), 2 deletions(-)\n\ndiff --git a/requests/auth.py b/requests/auth.py\nindex a3de123d30..f87087dfd2 100644\n--- a/requests/auth.py\n+++ b/requests/auth.py\n@@ -105,7 +105,7 @@ def sha_utf8(x):\n \n         A1 = '%s:%s:%s' % (self.username, realm, self.password)\n         A2 = '%s:%s' % (method, path)\n-        \n+\n         HA1 = hash_utf8(A1)\n         HA2 = hash_utf8(A2)\n \n@@ -144,7 +144,7 @@ def sha_utf8(x):\n         if entdig:\n             base += ', digest=\"%s\"' % entdig\n         if qop:\n-            base += ', qop=auth, nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n+            base += ', qop=\"auth\", nc=%s, cnonce=\"%s\"' % (ncvalue, cnonce)\n \n         return 'Digest %s' % (base)\n \ndiff --git a/test_requests.py b/test_requests.py\nindex 3b673956ce..4035695d34 100755\n--- a/test_requests.py\n+++ b/test_requests.py\n@@ -320,6 +320,14 @@ def test_DIGESTAUTH_WRONG_HTTP_401_GET(self):\n         r = s.get(url)\n         assert r.status_code == 401\n \n+    def test_DIGESTAUTH_QUOTES_QOP_VALUE(self):\n+\n+        auth = HTTPDigestAuth('user', 'pass')\n+        url = httpbin('digest-auth', 'auth', 'user', 'pass')\n+\n+        r = requests.get(url, auth=auth)\n+        assert '\"auth\"' in r.request.headers['Authorization']\n+\n     def test_POSTBIN_GET_POST_FILES(self):\n \n         url = httpbin('post')\n", "gold_standard_pr_link": "https://github.com/psf/requests/pull/1766"}