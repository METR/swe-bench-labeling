{"instance_id": "pylint-dev__pylint-4604", "score": "I", "diff": "diff --git a/pylint/checkers/variables.py b/pylint/checkers/variables.py\nindex 3ddafd599..ec8c6365a 100644\n--- a/pylint/checkers/variables.py\n+++ b/pylint/checkers/variables.py\n@@ -2080,7 +2080,9 @@ class VariablesChecker(BaseChecker):\n                             fields = (imported_name, stmt.modname, as_name)\n                             msg = \"%s imported from %s as %s\" % fields\n                         if not _is_type_checking_import(stmt):\n-                            self.add_message(\"unused-import\", args=msg, node=stmt)\n+                            # Check if the import is used in a type comment\n+                            if not self._is_import_used_in_type_comment(stmt, imported_name):\n+                                self.add_message(\"unused-import\", args=msg, node=stmt)\n         del self._to_consume\n \n     def _check_metaclasses(self, node):\n@@ -2146,6 +2148,14 @@ class VariablesChecker(BaseChecker):\n \n         return consumed\n \n+    def _is_import_used_in_type_comment(self, import_node, imported_name):\n+        \"\"\"Check if the imported name is used in a type comment.\"\"\"\n+        module = import_node.root()\n+        for node in module.body:\n+            if hasattr(node, 'type_comment'):\n+                if imported_name in node.type_comment:\n+                    return True\n+        return False\n \n def register(linter):\n     \"\"\"required method to auto register this checker\"\"\"\n", "gold_standard_diff": "diff --git a/CONTRIBUTORS.txt b/CONTRIBUTORS.txt\nindex b1de7ff30e..05e4a31e18 100644\n--- a/CONTRIBUTORS.txt\n+++ b/CONTRIBUTORS.txt\n@@ -503,3 +503,5 @@ contributors:\n * Markus Siebenhaar: contributor\n \n * Lorena Buciu (lorena-b): contributor\n+\n+* Sergei Lebedev (superbobry): contributor\ndiff --git a/ChangeLog b/ChangeLog\nindex c2b1382d7a..4ffa5a8414 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -171,6 +171,11 @@ Closes #4555\n \n   Closes #4023\n \n+* Fix ``unused-import`` false positive for imported modules referenced in\n+  attribute lookups in type comments.\n+\n+  Closes #4603\n+\n \n What's New in Pylint 2.8.3?\n ===========================\ndiff --git a/pylint/checkers/variables.py b/pylint/checkers/variables.py\nindex 3ddafd5994..8a46375097 100644\n--- a/pylint/checkers/variables.py\n+++ b/pylint/checkers/variables.py\n@@ -1826,6 +1826,10 @@ def _store_type_annotation_node(self, type_annotation):\n             self._type_annotation_names.append(type_annotation.name)\n             return\n \n+        if isinstance(type_annotation, astroid.Attribute):\n+            self._store_type_annotation_node(type_annotation.expr)\n+            return\n+\n         if not isinstance(type_annotation, astroid.Subscript):\n             return\n \ndiff --git a/pylint/constants.py b/pylint/constants.py\nindex b95d701c04..786cde7d02 100644\n--- a/pylint/constants.py\n+++ b/pylint/constants.py\n@@ -1,6 +1,7 @@\n # Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n # For details: https://github.com/PyCQA/pylint/blob/master/LICENSE\n \n+import platform\n import sys\n \n import astroid\n@@ -11,6 +12,7 @@\n PY39_PLUS = sys.version_info[:2] >= (3, 9)\n PY310_PLUS = sys.version_info[:2] >= (3, 10)\n \n+IS_PYPY = platform.python_implementation() == \"PyPy\"\n \n PY_EXTS = (\".py\", \".pyc\", \".pyo\", \".pyw\", \".so\", \".dll\")\n \ndiff --git a/tests/checkers/unittest_variables.py b/tests/checkers/unittest_variables.py\nindex 90daa8d5d1..2a590708d9 100644\n--- a/tests/checkers/unittest_variables.py\n+++ b/tests/checkers/unittest_variables.py\n@@ -21,11 +21,13 @@\n import os\n import re\n import sys\n+import unittest\n from pathlib import Path\n \n import astroid\n \n from pylint.checkers import variables\n+from pylint.constants import IS_PYPY\n from pylint.interfaces import UNDEFINED\n from pylint.testutils import CheckerTestCase, Message, linter, set_config\n \n@@ -191,6 +193,24 @@ def my_method(self) -> MyType:\n         with self.assertNoMessages():\n             self.walk(module)\n \n+    @unittest.skipIf(IS_PYPY, \"PyPy does not parse type comments\")\n+    def test_attribute_in_type_comment(self):\n+        \"\"\"Ensure attribute lookups in type comments are accounted for.\n+\n+        https://github.com/PyCQA/pylint/issues/4603\n+        \"\"\"\n+        module = astroid.parse(\n+            \"\"\"\n+        import foo\n+        from foo import Bar, Boo\n+        a = ... # type: foo.Bar\n+        b = ... # type: foo.Bar[Boo]\n+        c = ... # type: Bar.Boo\n+        \"\"\"\n+        )\n+        with self.assertNoMessages():\n+            self.walk(module)\n+\n \n class TestVariablesCheckerWithTearDown(CheckerTestCase):\n \n", "gold_standard_pr_link": "https://github.com/pylint-dev/pylint/pull/4604"}