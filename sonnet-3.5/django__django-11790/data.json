{"instance_id": "django__django-11790", "score": "I", "diff": "diff --git a/django/contrib/auth/forms.py b/django/contrib/auth/forms.py\nindex a0cfed0995..d232a8ac17 100644\n--- a/django/contrib/auth/forms.py\n+++ b/django/contrib/auth/forms.py\n@@ -166,6 +166,7 @@ class AuthenticationForm(forms.Form):\n     username/password logins.\n     \"\"\"\n     username = UsernameField(widget=forms.TextInput(attrs={'autofocus': True}))\n+    username.widget.attrs['maxlength'] = 254\n     password = forms.CharField(\n         label=_(\"Password\"),\n         strip=False,\n", "gold_standard_diff": "From 6c9778a58e4f680db180d4cc9dc5639d2ec1b40c Mon Sep 17 00:00:00 2001\nFrom: Sam Reynolds <sam@smjr.co.uk>\nDate: Tue, 17 Sep 2019 15:21:50 +0100\nSubject: [PATCH] Fixed #30776 -- Restored max length validation on\n AuthenticationForm.UsernameField.\n\nRegression in 5ceaf14686ce626404afb6a5fbd3d8286410bf13.\n\nThanks gopackgo90 for the report and Mariusz Felisiak for tests.\n---\n django/contrib/auth/forms.py   | 4 +++-\n tests/auth_tests/test_forms.py | 2 ++\n 2 files changed, 5 insertions(+), 1 deletion(-)\n\ndiff --git a/django/contrib/auth/forms.py b/django/contrib/auth/forms.py\nindex a0cfed09954e..b4fb55c1b4d2 100644\n--- a/django/contrib/auth/forms.py\n+++ b/django/contrib/auth/forms.py\n@@ -191,7 +191,9 @@ def __init__(self, request=None, *args, **kwargs):\n \n         # Set the max length and label for the \"username\" field.\n         self.username_field = UserModel._meta.get_field(UserModel.USERNAME_FIELD)\n-        self.fields['username'].max_length = self.username_field.max_length or 254\n+        username_max_length = self.username_field.max_length or 254\n+        self.fields['username'].max_length = username_max_length\n+        self.fields['username'].widget.attrs['maxlength'] = username_max_length\n         if self.fields['username'].label is None:\n             self.fields['username'].label = capfirst(self.username_field.verbose_name)\n \ndiff --git a/tests/auth_tests/test_forms.py b/tests/auth_tests/test_forms.py\nindex 7085dcfa1148..40e30501445b 100644\n--- a/tests/auth_tests/test_forms.py\n+++ b/tests/auth_tests/test_forms.py\n@@ -423,6 +423,7 @@ def test_username_field_max_length_matches_user_model(self):\n         CustomEmailField.objects.create_user(**data)\n         form = AuthenticationForm(None, data)\n         self.assertEqual(form.fields['username'].max_length, 255)\n+        self.assertEqual(form.fields['username'].widget.attrs.get('maxlength'), 255)\n         self.assertEqual(form.errors, {})\n \n     @override_settings(AUTH_USER_MODEL='auth_tests.IntegerUsernameUser')\n@@ -435,6 +436,7 @@ def test_username_field_max_length_defaults_to_254(self):\n         IntegerUsernameUser.objects.create_user(**data)\n         form = AuthenticationForm(None, data)\n         self.assertEqual(form.fields['username'].max_length, 254)\n+        self.assertEqual(form.fields['username'].widget.attrs.get('maxlength'), 254)\n         self.assertEqual(form.errors, {})\n \n     def test_username_field_label(self):\n", "gold_standard_pr_link": "https://github.com/django/django/pull/11790"}