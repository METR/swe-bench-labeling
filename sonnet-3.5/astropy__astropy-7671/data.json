{"instance_id": "astropy__astropy-7671", "score": "I", "diff": "", "gold_standard_diff": "From a85c6ef0c42c0c90cc66c66848090c3e93a849d0 Mon Sep 17 00:00:00 2001\nFrom: Larry Bradley <larry.bradley@gmail.com>\nDate: Fri, 20 Jul 2018 15:32:39 -0400\nSubject: [PATCH] Restore version regex for LooseVersion\n\n---\n astropy/utils/introspection.py            | 9 +++++++++\n astropy/utils/tests/test_introspection.py | 2 +-\n 2 files changed, 10 insertions(+), 1 deletion(-)\n\ndiff --git a/astropy/utils/introspection.py b/astropy/utils/introspection.py\nindex 3e784f9fc340..e437b40c8711 100644\n--- a/astropy/utils/introspection.py\n+++ b/astropy/utils/introspection.py\n@@ -4,6 +4,7 @@\n \n \n import inspect\n+import re\n import types\n import importlib\n from distutils.version import LooseVersion\n@@ -139,6 +140,14 @@ def minversion(module, version, inclusive=True, version_path='__version__'):\n     else:\n         have_version = resolve_name(module.__name__, version_path)\n \n+    # LooseVersion raises a TypeError when strings like dev, rc1 are part\n+    # of the version number. Match the dotted numbers only. Regex taken\n+    # from PEP440, https://www.python.org/dev/peps/pep-0440/, Appendix B\n+    expr = '^([1-9]\\\\d*!)?(0|[1-9]\\\\d*)(\\\\.(0|[1-9]\\\\d*))*'\n+    m = re.match(expr, version)\n+    if m:\n+        version = m.group(0)\n+\n     if inclusive:\n         return LooseVersion(have_version) >= LooseVersion(version)\n     else:\ndiff --git a/astropy/utils/tests/test_introspection.py b/astropy/utils/tests/test_introspection.py\nindex d8262d4581a9..99dd9de7305d 100644\n--- a/astropy/utils/tests/test_introspection.py\n+++ b/astropy/utils/tests/test_introspection.py\n@@ -67,7 +67,7 @@ def test_minversion():\n     from types import ModuleType\n     test_module = ModuleType(str(\"test_module\"))\n     test_module.__version__ = '0.12.2'\n-    good_versions = ['0.12', '0.12.1', '0.12.0.dev']\n+    good_versions = ['0.12', '0.12.1', '0.12.0.dev', '0.12dev']\n     bad_versions = ['1', '1.2rc1']\n     for version in good_versions:\n         assert minversion(test_module, version)\n", "gold_standard_pr_link": "https://github.com/astropy/astropy/pull/7671"}