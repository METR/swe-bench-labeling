{"instance_id": "psf__requests-5414", "score": "I", "diff": "diff --git a/requests/models.py b/requests/models.py\nindex e7d292d5..71fcd897 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -405,6 +405,8 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n                 raise InvalidURL('URL has an invalid label.')\n         elif host.startswith(u'*'):\n             raise InvalidURL('URL has an invalid label.')\n+        elif host.startswith(u'.'):\n+            raise InvalidURL('URL has an invalid label.')\n \n         # Carefully reconstruct the network location\n         netloc = auth or ''\n", "gold_standard_diff": "diff --git a/requests/models.py b/requests/models.py\nindex e7d292d580..d86388182b 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -403,7 +403,7 @@ def prepare_url(self, url, params):\n                 host = self._get_idna_encoded_host(host)\n             except UnicodeError:\n                 raise InvalidURL('URL has an invalid label.')\n-        elif host.startswith(u'*'):\n+        elif host.startswith((u'*', u'.')):\n             raise InvalidURL('URL has an invalid label.')\n \n         # Carefully reconstruct the network location\ndiff --git a/tests/test_requests.py b/tests/test_requests.py\nindex 463e8bf47a..29b3aca84e 100644\n--- a/tests/test_requests.py\n+++ b/tests/test_requests.py\n@@ -81,6 +81,8 @@ def test_entry_points(self):\n             (InvalidSchema, 'localhost.localdomain:3128/'),\n             (InvalidSchema, '10.122.1.1:3128/'),\n             (InvalidURL, 'http://'),\n+            (InvalidURL, 'http://*example.com'),\n+            (InvalidURL, 'http://.example.com'),\n         ))\n     def test_invalid_url(self, exception, url):\n         with pytest.raises(exception):\n", "gold_standard_pr_link": "https://github.com/psf/requests/pull/5414"}