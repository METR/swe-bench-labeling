{"instance_id": "pytest-dev__pytest-7982", "score": "C", "diff": "diff --git a/src/_pytest/pathlib.py b/src/_pytest/pathlib.py\nindex f0bdb1481..b96cba069 100644\n--- a/src/_pytest/pathlib.py\n+++ b/src/_pytest/pathlib.py\n@@ -558,7 +558,7 @@ def visit(\n     entries = sorted(os.scandir(path), key=lambda entry: entry.name)\n     yield from entries\n     for entry in entries:\n-        if entry.is_dir(follow_symlinks=False) and recurse(entry):\n+        if entry.is_dir() and recurse(entry):\n             yield from visit(entry.path, recurse)\n \n \n", "gold_standard_diff": "From 6cdae8ed40e329d82c6ae96dbb3eeff4be5ef5f4 Mon Sep 17 00:00:00 2001\nFrom: Ran Benita <ran@unusedvar.com>\nDate: Sat, 31 Oct 2020 13:55:02 +0200\nSubject: [PATCH] pathlib: fix symlinked directories not followed during\n collection\n\n---\n changelog/7981.bugfix.rst  |  1 +\n src/_pytest/pathlib.py     |  2 +-\n testing/test_collection.py | 10 ++++++++++\n 3 files changed, 12 insertions(+), 1 deletion(-)\n create mode 100644 changelog/7981.bugfix.rst\n\ndiff --git a/changelog/7981.bugfix.rst b/changelog/7981.bugfix.rst\nnew file mode 100644\nindex 00000000000..0a254b5d49d\n--- /dev/null\n+++ b/changelog/7981.bugfix.rst\n@@ -0,0 +1 @@\n+Fixed symlinked directories not being followed during collection. Regressed in pytest 6.1.0.\ndiff --git a/src/_pytest/pathlib.py b/src/_pytest/pathlib.py\nindex f0bdb1481bb..b96cba06982 100644\n--- a/src/_pytest/pathlib.py\n+++ b/src/_pytest/pathlib.py\n@@ -558,7 +558,7 @@ def visit(\n     entries = sorted(os.scandir(path), key=lambda entry: entry.name)\n     yield from entries\n     for entry in entries:\n-        if entry.is_dir(follow_symlinks=False) and recurse(entry):\n+        if entry.is_dir() and recurse(entry):\n             yield from visit(entry.path, recurse)\n \n \ndiff --git a/testing/test_collection.py b/testing/test_collection.py\nindex 841aa358b96..4a7a3e620c5 100644\n--- a/testing/test_collection.py\n+++ b/testing/test_collection.py\n@@ -9,6 +9,7 @@\n from _pytest.main import _in_venv\n from _pytest.main import Session\n from _pytest.pathlib import symlink_or_skip\n+from _pytest.pytester import Pytester\n from _pytest.pytester import Testdir\n \n \n@@ -1178,6 +1179,15 @@ def test_nodeid(request):\n     assert result.ret == 0\n \n \n+def test_collect_symlink_dir(pytester: Pytester) -> None:\n+    \"\"\"A symlinked directory is collected.\"\"\"\n+    dir = pytester.mkdir(\"dir\")\n+    dir.joinpath(\"test_it.py\").write_text(\"def test_it(): pass\", \"utf-8\")\n+    pytester.path.joinpath(\"symlink_dir\").symlink_to(dir)\n+    result = pytester.runpytest()\n+    result.assert_outcomes(passed=2)\n+\n+\n def test_collectignore_via_conftest(testdir):\n     \"\"\"collect_ignore in parent conftest skips importing child (issue #4592).\"\"\"\n     tests = testdir.mkpydir(\"tests\")\n", "gold_standard_pr_link": "https://github.com/pytest-dev/pytest/pull/7982"}