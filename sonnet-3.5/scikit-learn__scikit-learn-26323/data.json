{"instance_id": "scikit-learn__scikit-learn-26323", "score": "C", "diff": "diff --git a/sklearn/compose/_column_transformer.py b/sklearn/compose/_column_transformer.py\nindex 4eddd12b1..b698b42e6 100644\n--- a/sklearn/compose/_column_transformer.py\n+++ b/sklearn/compose/_column_transformer.py\n@@ -275,8 +275,8 @@ class ColumnTransformer(TransformerMixin, _BaseComposition):\n     def set_output(self, *, transform=None):\n         \"\"\"Set the output container when `\"transform\"` and `\"fit_transform\"` are called.\n \n-        Calling `set_output` will set the output of all estimators in `transformers`\n-        and `transformers_`.\n+        Calling `set_output` will set the output of all estimators in `transformers`,\n+        `transformers_`, and `remainder` if it's an estimator.\n \n         Parameters\n         ----------\n@@ -293,12 +293,10 @@ class ColumnTransformer(TransformerMixin, _BaseComposition):\n             Estimator instance.\n         \"\"\"\n         super().set_output(transform=transform)\n-        transformers = (\n-            trans\n-            for _, trans, _ in chain(\n-                self.transformers, getattr(self, \"transformers_\", [])\n-            )\n-            if trans not in {\"passthrough\", \"drop\"}\n+        transformers = chain(\n+            (trans for _, trans, _ in chain(self.transformers, getattr(self, \"transformers_\", []))\n+             if trans not in {\"passthrough\", \"drop\"}),\n+            [self.remainder] if hasattr(self.remainder, \"set_output\") else []\n         )\n         for trans in transformers:\n             _safe_set_output(trans, transform=transform)\ndiff --git a/sklearn/compose/tests/test_column_transformer.py b/sklearn/compose/tests/test_column_transformer.py\nindex b9c8f5831..d7f2c189b 100644\n--- a/sklearn/compose/tests/test_column_transformer.py\n+++ b/sklearn/compose/tests/test_column_transformer.py\n@@ -2185,3 +2185,21 @@ def test_raise_error_if_index_not_aligned():\n     )\n     with pytest.raises(ValueError, match=msg):\n         ct.fit_transform(X)\n+\n+def test_column_transformer_set_output():\n+    pd = pytest.importorskip(\"pandas\")\n+    X = pd.DataFrame({\"a\": [1, 2, 3], \"b\": [4, 5, 6], \"c\": [7, 8, 9]})\n+    \n+    ct = ColumnTransformer(\n+        [(\"trans1\", StandardScaler(), [\"a\", \"b\"])],\n+        remainder=StandardScaler()\n+    )\n+    ct.set_output(transform=\"pandas\")\n+    \n+    result = ct.fit_transform(X)\n+    assert isinstance(result, pd.DataFrame)\n+    assert list(result.columns) == [\"a\", \"b\", \"c\"]\n+    \n+    # Test that the remainder transformer is also set to output pandas\n+    remainder_output = ct.named_transformers_[\"remainder\"].transform(X[[\"c\"]])\n+    assert isinstance(remainder_output, pd.DataFrame)\n\\ No newline at end of file\n", "gold_standard_diff": "diff --git a/doc/whats_new/v1.3.rst b/doc/whats_new/v1.3.rst\nindex fdceb35b6e4f6..ea5157d8824c8 100644\n--- a/doc/whats_new/v1.3.rst\n+++ b/doc/whats_new/v1.3.rst\n@@ -235,6 +235,9 @@ Changelog\n   output pandas dataframes with indexes that are not consistent with each other and the output is configured\n   to be pandas. :pr:`26286` by `Thomas Fan`_.\n \n+- |Fix| :class:`compose.ColumnTransformer` correctly sets the output of the\n+  remainder when `set_output` is called. :pr:`26323` by `Thomas Fan`_.\n+\n :mod:`sklearn.covariance`\n .........................\n \ndiff --git a/sklearn/compose/_column_transformer.py b/sklearn/compose/_column_transformer.py\nindex 4eddd12b1baea..aab021c0c8d4f 100644\n--- a/sklearn/compose/_column_transformer.py\n+++ b/sklearn/compose/_column_transformer.py\n@@ -293,6 +293,7 @@ def set_output(self, *, transform=None):\n             Estimator instance.\n         \"\"\"\n         super().set_output(transform=transform)\n+\n         transformers = (\n             trans\n             for _, trans, _ in chain(\n@@ -303,6 +304,9 @@ def set_output(self, *, transform=None):\n         for trans in transformers:\n             _safe_set_output(trans, transform=transform)\n \n+        if self.remainder not in {\"passthrough\", \"drop\"}:\n+            _safe_set_output(self.remainder, transform=transform)\n+\n         return self\n \n     def get_params(self, deep=True):\ndiff --git a/sklearn/compose/tests/test_column_transformer.py b/sklearn/compose/tests/test_column_transformer.py\nindex b9c8f58317e4e..cb9ddc0b4f344 100644\n--- a/sklearn/compose/tests/test_column_transformer.py\n+++ b/sklearn/compose/tests/test_column_transformer.py\n@@ -22,6 +22,7 @@\n from sklearn.exceptions import NotFittedError\n from sklearn.preprocessing import FunctionTransformer\n from sklearn.preprocessing import StandardScaler, Normalizer, OneHotEncoder\n+from sklearn.feature_selection import VarianceThreshold\n \n \n class Trans(TransformerMixin, BaseEstimator):\n@@ -2185,3 +2186,27 @@ def test_raise_error_if_index_not_aligned():\n     )\n     with pytest.raises(ValueError, match=msg):\n         ct.fit_transform(X)\n+\n+\n+def test_remainder_set_output():\n+    \"\"\"Check that the output is set for the remainder.\n+\n+    Non-regression test for #26306.\n+    \"\"\"\n+\n+    pd = pytest.importorskip(\"pandas\")\n+    df = pd.DataFrame({\"a\": [True, False, True], \"b\": [1, 2, 3]})\n+\n+    ct = make_column_transformer(\n+        (VarianceThreshold(), make_column_selector(dtype_include=bool)),\n+        remainder=VarianceThreshold(),\n+        verbose_feature_names_out=False,\n+    )\n+    ct.set_output(transform=\"pandas\")\n+\n+    out = ct.fit_transform(df)\n+    pd.testing.assert_frame_equal(out, df)\n+\n+    ct.set_output(transform=\"default\")\n+    out = ct.fit_transform(df)\n+    assert isinstance(out, np.ndarray)\n", "gold_standard_pr_link": "https://github.com/scikit-learn/scikit-learn/pull/26323"}