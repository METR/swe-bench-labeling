{"instance_id": "matplotlib__matplotlib-24627", "score": "I", "diff": "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 90b0bf117e..b5ea114805 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1401,6 +1401,12 @@ class _AxesBase(martist.Artist):\n         else:\n             self.__clear()\n \n+    def cla(self):\n+        \"\"\"Clear the Axes.\"\"\"\n+        # Act as an alias, or as the superclass implementation depending on the\n+        # subclass implementation.\n+        if self._subclass_uses_cla:\n+            self.__clear()\n     def cla(self):\n         \"\"\"Clear the Axes.\"\"\"\n         # Act as an alias, or as the superclass implementation depending on the\n@@ -1409,10 +1415,10 @@ class _AxesBase(martist.Artist):\n             self.__clear()\n         else:\n             self.clear()\n-\n-    class ArtistList(MutableSequence):\n-        \"\"\"\n-        A sublist of Axes children based on their type.\n+        \n+        # Unset .axes attribute of deparented artists\n+        for artist in self.get_children():\n+            artist.axes = None\n \n         The type-specific children sublists will become immutable in\n         Matplotlib 3.7. Then, these artist lists will likely be replaced by\ndiff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex 6c18ba1a64..b9f51e2650 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -929,8 +929,18 @@ default: %(va)s\n         _break_share_link(ax, ax._twinned_axes)\n \n     def clear(self, keep_observers=False):\n-        \"\"\"\n-        Clear the figure.\n+        \"\"\"Clear the figure.\"\"\"\n+        # Unset .figure attribute of deparented artists\n+        for ax in self.axes:\n+            for artist in ax.get_children():\n+                artist.figure = None\n+                artist.axes = None\n+        \n+        # Original clear implementation\n+        super().clear(keep_observers=keep_observers)\n+        toolbar = self.canvas.toolbar\n+        if toolbar is not None:\n+            toolbar.update()\n \n         Parameters\n         ----------\n@@ -3039,10 +3049,15 @@ class Figure(FigureBase):\n         self.set_size_inches(self.get_figwidth(), val, forward=forward)\n \n     def clear(self, keep_observers=False):\n-        # docstring inherited\n+        \"\"\"Clear the figure.\"\"\"\n+        # Unset .figure attribute of deparented artists\n+        for ax in self.axes:\n+            for artist in ax.get_children():\n+                artist.figure = None\n+                artist.axes = None\n+        \n+        # Original clear implementation\n         super().clear(keep_observers=keep_observers)\n-        # FigureBase.clear does not clear toolbars, as\n-        # only Figure can have toolbars\n         toolbar = self.canvas.toolbar\n         if toolbar is not None:\n             toolbar.update()\n", "gold_standard_diff": "diff --git a/lib/matplotlib/axes/_base.py b/lib/matplotlib/axes/_base.py\nindex 574310ea763a..4ea2b2433706 100644\n--- a/lib/matplotlib/axes/_base.py\n+++ b/lib/matplotlib/axes/_base.py\n@@ -1315,7 +1315,9 @@ def __clear(self):\n         self._get_patches_for_fill = _process_plot_var_args(self, 'fill')\n \n         self._gridOn = mpl.rcParams['axes.grid']\n-        self._children = []\n+        old_children, self._children = self._children, []\n+        for chld in old_children:\n+            chld.axes = chld.figure = None\n         self._mouseover_set = _OrderedSet()\n         self.child_axes = []\n         self._current_image = None  # strictly for pyplot via _sci, _gci\ndiff --git a/lib/matplotlib/tests/test_axes.py b/lib/matplotlib/tests/test_axes.py\nindex deb6c3fb2ba1..680602f706e7 100644\n--- a/lib/matplotlib/tests/test_axes.py\n+++ b/lib/matplotlib/tests/test_axes.py\n@@ -8359,6 +8359,19 @@ def test_extent_units():\n         im.set_extent([2, 12, date_first, date_last], clip=False)\n \n \n+def test_cla_clears_children_axes_and_fig():\n+    fig, ax = plt.subplots()\n+    lines = ax.plot([], [], [], [])\n+    img = ax.imshow([[1]])\n+    for art in lines + [img]:\n+        assert art.axes is ax\n+        assert art.figure is fig\n+    ax.clear()\n+    for art in lines + [img]:\n+        assert art.axes is None\n+        assert art.figure is None\n+\n+\n def test_scatter_color_repr_error():\n \n     def get_next_color():\n", "gold_standard_pr_link": "https://github.com/matplotlib/matplotlib/pull/24627"}