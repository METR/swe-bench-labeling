{"instance_id": "pytest-dev__pytest-7521", "score": "C", "diff": "diff --git a/src/_pytest/capture.py b/src/_pytest/capture.py\nindex 3f9c60fb9..f538b67ec 100644\n--- a/src/_pytest/capture.py\n+++ b/src/_pytest/capture.py\n@@ -388,6 +388,7 @@ class FDCaptureBinary:\n                 TemporaryFile(buffering=0),  # type: ignore[arg-type]\n                 encoding=\"utf-8\",\n                 errors=\"replace\",\n+                newline=\"\",\n                 write_through=True,\n             )\n             if targetfd in patchsysdict:\ndiff --git a/testing/test_capture.py b/testing/test_capture.py\nindex a3bd4b623..18b8b98e2 100644\n--- a/testing/test_capture.py\n+++ b/testing/test_capture.py\n@@ -777,6 +777,25 @@ def test_capture_binary_output(testdir):\n     result.assert_outcomes(passed=2)\n \n \n+def test_capfd_preserves_carriage_return(testdir):\n+    \"\"\"Test that capfd preserves carriage return characters. Regression test for issue #7509.\"\"\"\n+    testdir.makepyfile(\n+        \"\"\"\n+        def test_capfd_includes_carriage_return(capfd):\n+            print('Greetings from DOS', end='\\\\r')\n+            out, err = capfd.readouterr()\n+            assert out == 'Greetings from DOS\\\\r'\n+            \n+        def test_capsys_includes_carriage_return(capsys):\n+            print('Greetings from DOS', end='\\\\r')\n+            out, err = capsys.readouterr()\n+            assert out == 'Greetings from DOS\\\\r'\n+        \"\"\"\n+    )\n+    result = testdir.runpytest()\n+    result.assert_outcomes(passed=2)\n+\n+\n def test_error_during_readouterr(testdir):\n     \"\"\"Make sure we suspend capturing if errors occur during readouterr\"\"\"\n     testdir.makepyfile(\n", "gold_standard_diff": "diff --git a/changelog/7517.bugfix.rst b/changelog/7517.bugfix.rst\nnew file mode 100644\nindex 00000000000..2d062dc1e29\n--- /dev/null\n+++ b/changelog/7517.bugfix.rst\n@@ -0,0 +1 @@\n+Preserve line endings when captured via ``capfd``.\ndiff --git a/src/_pytest/capture.py b/src/_pytest/capture.py\nindex 3f9c60fb9a0..f538b67eceb 100644\n--- a/src/_pytest/capture.py\n+++ b/src/_pytest/capture.py\n@@ -388,6 +388,7 @@ def __init__(self, targetfd: int) -> None:\n                 TemporaryFile(buffering=0),  # type: ignore[arg-type]\n                 encoding=\"utf-8\",\n                 errors=\"replace\",\n+                newline=\"\",\n                 write_through=True,\n             )\n             if targetfd in patchsysdict:\ndiff --git a/testing/test_capture.py b/testing/test_capture.py\nindex a3bd4b62327..bc89501c73b 100644\n--- a/testing/test_capture.py\n+++ b/testing/test_capture.py\n@@ -514,6 +514,12 @@ def test_hello(capfd):\n         )\n         reprec.assertoutcome(passed=1)\n \n+    @pytest.mark.parametrize(\"nl\", (\"\\n\", \"\\r\\n\", \"\\r\"))\n+    def test_cafd_preserves_newlines(self, capfd, nl):\n+        print(\"test\", end=nl)\n+        out, err = capfd.readouterr()\n+        assert out.endswith(nl)\n+\n     def test_capfdbinary(self, testdir):\n         reprec = testdir.inline_runsource(\n             \"\"\"\\\n", "gold_standard_pr_link": "https://github.com/pytest-dev/pytest/pull/7521"}