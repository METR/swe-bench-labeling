{"instance_id": "django__django-10097", "score": "I", "diff": "diff --git a/django/core/validators.py b/django/core/validators.py\nindex 92394a7eae..51f191812d 100644\n--- a/django/core/validators.py\n+++ b/django/core/validators.py\n@@ -536,3 +536,17 @@ class ProhibitNullCharactersValidator:\n             self.message == other.message and\n             self.code == other.code\n         )\n+\n+    def validate_auth_characters(self, url):\n+        \"\"\"\n+        Validate that the username and password in the URL do not contain invalid characters.\n+        \"\"\"\n+        import re\n+        auth_part = re.match(r'^(?:[a-z0-9\\.\\-\\+]*)://(?:([^@]+)@)?', url, re.IGNORECASE)\n+        if auth_part and auth_part.group(1):\n+            if re.search(r'[/:@]', auth_part.group(1)):\n+                raise ValidationError(self.message, code=self.code)\n+\n+    def __call__(self, value):\n+        super().__call__(value)\n+        self.validate_auth_characters(value)\n", "gold_standard_diff": "From f34dcb09f9e2e28b751015aa119c12f5f2814ee9 Mon Sep 17 00:00:00 2001\nFrom: Tim Bell <timothybell@gmail.com>\nDate: Wed, 27 Jun 2018 09:23:18 +1000\nSubject: [PATCH 1/5] Fix #29528 -- Corrected regex used to validate URLs\n\n---\n django/core/validators.py         | 2 +-\n tests/validators/invalid_urls.txt | 2 ++\n 2 files changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a/django/core/validators.py b/django/core/validators.py\nindex 92394a7eaead..c1c9cd1c87e8 100644\n--- a/django/core/validators.py\n+++ b/django/core/validators.py\n@@ -94,7 +94,7 @@ class URLValidator(RegexValidator):\n \n     regex = _lazy_re_compile(\n         r'^(?:[a-z0-9\\.\\-\\+]*)://'  # scheme is validated separately\n-        r'(?:\\S+(?::\\S*)?@)?'  # user:pass authentication\n+        r'(?:[^\\s:@/]+(?::[^\\s:@/]*)?@)?'  # user:pass authentication\n         r'(?:' + ipv4_re + '|' + ipv6_re + '|' + host_re + ')'\n         r'(?::\\d{2,5})?'  # port\n         r'(?:[/?#][^\\s]*)?'  # resource path\ndiff --git a/tests/validators/invalid_urls.txt b/tests/validators/invalid_urls.txt\nindex 04a0b5fb1b5f..b9f6eadd78b9 100644\n--- a/tests/validators/invalid_urls.txt\n+++ b/tests/validators/invalid_urls.txt\n@@ -57,3 +57,5 @@ http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\n http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n http://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaa\n https://test.[com\n+http://foo/bar@example.com\n+http://invalid-.com/?m=foo@example.com\n\nFrom fe293483fd15c7037974cbb3d6e73c093d68b1de Mon Sep 17 00:00:00 2001\nFrom: Tim Bell <timothybell@gmail.com>\nDate: Wed, 27 Jun 2018 09:23:54 +1000\nSubject: [PATCH 2/5] Refs #29528 -- Remove test case of URL that should be\n invalid\n\n---\n tests/validators/valid_urls.txt | 1 -\n 1 file changed, 1 deletion(-)\n\ndiff --git a/tests/validators/valid_urls.txt b/tests/validators/valid_urls.txt\nindex 4bc8c03059c0..6391eed44965 100644\n--- a/tests/validators/valid_urls.txt\n+++ b/tests/validators/valid_urls.txt\n@@ -48,7 +48,6 @@ http://foo.bar/?q=Test%20URL-encoded%20stuff\n http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631\n http://\u4f8b\u5b50.\u6d4b\u8bd5\n http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e\n-http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\n http://xn--7sbb4ac0ad0be6cf.xn--p1ai\n http://1337.net\n http://a.b-c.de\n\nFrom d579001d95e172d6231fdf5768acf7c6fa8788d8 Mon Sep 17 00:00:00 2001\nFrom: Tim Bell <timothybell@gmail.com>\nDate: Wed, 27 Jun 2018 09:23:54 +1000\nSubject: [PATCH 3/5] Revert \"Refs #29528 -- Remove test case of URL that\n should be invalid\"\n\nThis reverts commit fe293483fd15c7037974cbb3d6e73c093d68b1de.\n---\n tests/validators/valid_urls.txt | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a/tests/validators/valid_urls.txt b/tests/validators/valid_urls.txt\nindex 6391eed44965..4bc8c03059c0 100644\n--- a/tests/validators/valid_urls.txt\n+++ b/tests/validators/valid_urls.txt\n@@ -48,6 +48,7 @@ http://foo.bar/?q=Test%20URL-encoded%20stuff\n http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631\n http://\u4f8b\u5b50.\u6d4b\u8bd5\n http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e\n+http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\n http://xn--7sbb4ac0ad0be6cf.xn--p1ai\n http://1337.net\n http://a.b-c.de\n\nFrom 07d9f8553976a6d6370377c17e43a6b9ccadce2a Mon Sep 17 00:00:00 2001\nFrom: Tim Bell <timothybell@gmail.com>\nDate: Fri, 20 Jul 2018 10:24:31 +1000\nSubject: [PATCH 4/5] Refs #29528 -- Adjust test case of valid URL\n\n---\n tests/validators/valid_urls.txt | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a/tests/validators/valid_urls.txt b/tests/validators/valid_urls.txt\nindex 4bc8c03059c0..f79f94814291 100644\n--- a/tests/validators/valid_urls.txt\n+++ b/tests/validators/valid_urls.txt\n@@ -48,7 +48,7 @@ http://foo.bar/?q=Test%20URL-encoded%20stuff\n http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631\n http://\u4f8b\u5b50.\u6d4b\u8bd5\n http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e\n-http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\n+http://-.~_!$&'()*+,;=%40:80%2f@example.com\n http://xn--7sbb4ac0ad0be6cf.xn--p1ai\n http://1337.net\n http://a.b-c.de\n\nFrom 5e4d354e2dad0f2b4002d3e2eafe9ea8ca6a8a1f Mon Sep 17 00:00:00 2001\nFrom: Tim Bell <timothybell@gmail.com>\nDate: Mon, 23 Jul 2018 07:38:49 +1000\nSubject: [PATCH 5/5] Refs #29528 -- Add more test cases of invalid URLs\n\n---\n tests/validators/invalid_urls.txt | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a/tests/validators/invalid_urls.txt b/tests/validators/invalid_urls.txt\nindex b9f6eadd78b9..4a092034ff66 100644\n--- a/tests/validators/invalid_urls.txt\n+++ b/tests/validators/invalid_urls.txt\n@@ -57,5 +57,9 @@ http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\n http://example.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n http://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaa\n https://test.[com\n+http://foo@bar@example.com\n http://foo/bar@example.com\n+http://foo:bar:baz@example.com\n+http://foo:bar@baz@example.com\n+http://foo:bar/baz@example.com\n http://invalid-.com/?m=foo@example.com\n", "gold_standard_pr_link": "https://github.com/django/django/pull/10097"}