{"instance_id": "psf__requests-5414", "score": "I", "diff": "diff --git a/requests/models.py b/requests/models.py\nindex e7d292d5..e2889bcd 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -403,7 +403,7 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n                 host = self._get_idna_encoded_host(host)\n             except UnicodeError:\n                 raise InvalidURL('URL has an invalid label.')\n-        elif host.startswith(u'*'):\n+        elif host.startswith(u'*') or host.startswith('.'):\n             raise InvalidURL('URL has an invalid label.')\n \n         # Carefully reconstruct the network location\n", "gold_standard_diff": "From 658c10e84a461e5298199f20f17b510b90ac478a Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?=C3=81lvaro=20Mond=C3=A9jar?= <mondejar1994@gmail.com>\nDate: Sun, 5 Apr 2020 18:47:21 +0200\nSubject: [PATCH] Raise InvalidURL if hosts starts with '.' as was reported at\n #5367.\n\n---\n requests/models.py     | 2 +-\n tests/test_requests.py | 2 ++\n 2 files changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a/requests/models.py b/requests/models.py\nindex e7d292d580..d86388182b 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -403,7 +403,7 @@ def prepare_url(self, url, params):\n                 host = self._get_idna_encoded_host(host)\n             except UnicodeError:\n                 raise InvalidURL('URL has an invalid label.')\n-        elif host.startswith(u'*'):\n+        elif host.startswith((u'*', u'.')):\n             raise InvalidURL('URL has an invalid label.')\n \n         # Carefully reconstruct the network location\ndiff --git a/tests/test_requests.py b/tests/test_requests.py\nindex 463e8bf47a..29b3aca84e 100644\n--- a/tests/test_requests.py\n+++ b/tests/test_requests.py\n@@ -81,6 +81,8 @@ def test_entry_points(self):\n             (InvalidSchema, 'localhost.localdomain:3128/'),\n             (InvalidSchema, '10.122.1.1:3128/'),\n             (InvalidURL, 'http://'),\n+            (InvalidURL, 'http://*example.com'),\n+            (InvalidURL, 'http://.example.com'),\n         ))\n     def test_invalid_url(self, exception, url):\n         with pytest.raises(exception):\n", "gold_standard_pr_link": "https://github.com/psf/requests/pull/5414"}