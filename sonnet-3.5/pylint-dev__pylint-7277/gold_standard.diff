From 1f1e837239f4cc75df4b546e82e38a2906151629 Mon Sep 17 00:00:00 2001
From: Karthik Nadig <kanadig@microsoft.com>
Date: Mon, 8 Aug 2022 16:04:10 -0700
Subject: [PATCH 1/3] Check for cwd before removing it form `sys.path`.

---
 pylint/__init__.py |  5 +++--
 tests/test_self.py | 18 ++++++++++++++++++
 2 files changed, 21 insertions(+), 2 deletions(-)

diff --git a/pylint/__init__.py b/pylint/__init__.py
index 9f3dd74e67..8f1eaebe01 100644
--- a/pylint/__init__.py
+++ b/pylint/__init__.py
@@ -96,9 +96,10 @@ def modify_sys_path() -> None:
       if pylint is installed in an editable configuration (as the last item).
       https://github.com/PyCQA/pylint/issues/4161
     """
-    sys.path.pop(0)
-    env_pythonpath = os.environ.get("PYTHONPATH", "")
     cwd = os.getcwd()
+    if sys.path[0] in ("", ".", cwd):
+        sys.path.pop(0)
+    env_pythonpath = os.environ.get("PYTHONPATH", "")
     if env_pythonpath.startswith(":") and env_pythonpath not in (f":{cwd}", ":."):
         sys.path.pop(0)
     elif env_pythonpath.endswith(":") and env_pythonpath not in (f"{cwd}:", ".:"):
diff --git a/tests/test_self.py b/tests/test_self.py
index 7c11601a93..53c9fb11bc 100644
--- a/tests/test_self.py
+++ b/tests/test_self.py
@@ -759,6 +759,24 @@ def test_modify_sys_path() -> None:
                 modify_sys_path()
             assert sys.path == paths[1:]
 
+            paths = ["", *default_paths]
+            sys.path = copy(paths)
+            with _test_environ_pythonpath():
+                modify_sys_path()
+            assert sys.path == paths[1:]
+
+            paths = [".", *default_paths]
+            sys.path = copy(paths)
+            with _test_environ_pythonpath():
+                modify_sys_path()
+            assert sys.path == paths[1:]
+
+            paths = ["/do_not_remove", *default_paths]
+            sys.path = copy(paths)
+            with _test_environ_pythonpath():
+                modify_sys_path()
+            assert sys.path == paths
+
             paths = [cwd, cwd, *default_paths]
             sys.path = copy(paths)
             with _test_environ_pythonpath("."):

From 32c69e5c57c6f3d369dbab39899b3ecbadc8c10c Mon Sep 17 00:00:00 2001
From: Karthik Nadig <kanadig@microsoft.com>
Date: Mon, 8 Aug 2022 17:22:46 -0700
Subject: [PATCH 2/3] Add news.

---
 doc/whatsnew/fragments/7231.bugfix | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 doc/whatsnew/fragments/7231.bugfix

diff --git a/doc/whatsnew/fragments/7231.bugfix b/doc/whatsnew/fragments/7231.bugfix
new file mode 100644
index 0000000000..c47fa1d1bc
--- /dev/null
+++ b/doc/whatsnew/fragments/7231.bugfix
@@ -0,0 +1,3 @@
+Check for `<cwd>` before removing first item form `sys.path` in `modify_sys_path`.
+
+Closes #7231

From 1f16621bc4afdb02e23315810ca1f618800ace8a Mon Sep 17 00:00:00 2001
From: Jacob Walls <jacobtylerwalls@gmail.com>
Date: Tue, 9 Aug 2022 07:45:09 -0400
Subject: [PATCH 3/3] Update doc/whatsnew/fragments/7231.bugfix

---
 doc/whatsnew/fragments/7231.bugfix | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/doc/whatsnew/fragments/7231.bugfix b/doc/whatsnew/fragments/7231.bugfix
index c47fa1d1bc..5c8837e423 100644
--- a/doc/whatsnew/fragments/7231.bugfix
+++ b/doc/whatsnew/fragments/7231.bugfix
@@ -1,3 +1,3 @@
-Check for `<cwd>` before removing first item form `sys.path` in `modify_sys_path`.
+Check for `<cwd>` before removing first item from `sys.path` in `modify_sys_path`.
 
 Closes #7231
